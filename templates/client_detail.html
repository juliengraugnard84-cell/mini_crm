{% extends "base.html" %}
{% block title %}Client — {{ client.name }}{% endblock %}

{% block content %}

<h1>{{ client.name }}</h1>

<!-- ===================== -->
<!-- INFOS CLIENT -->
<!-- ===================== -->
<div class="card">
    <h5>Informations client</h5>

    <div class="grid-3">
        <div>
            <strong>Commercial</strong><br>
            {{ client.commercial or "—" }}
        </div>

        <div>
            <strong>Date de création</strong><br>
            {{ client.created_at }}
        </div>

        <div>
            <strong>Statut</strong><br>
            {{ client.status or "Cotation" }}
        </div>
    </div>
</div>

<!-- ===================== -->
<!-- DEMANDE DE COTATION -->
<!-- ===================== -->
<div class="card" style="margin-top:24px;">
    <h5>Nouvelle demande de cotation</h5>

    <form method="POST"
          action="{{ url_for('create_cotation', client_id=client.id) }}">

        <div class="form-group">
            <label>Date de négociation</label>
            <input type="date" name="date_negociation" class="form-control">
        </div>

        <div class="form-group">
            <label>Nom du signataire</label>
            <input type="text" name="signataire_nom" class="form-control">
        </div>

        <div class="form-group">
            <label>Téléphone</label>
            <input type="tel" name="signataire_tel" class="form-control">
        </div>

        <div class="form-group">
            <label>Email</label>
            <input type="email" name="signataire_email" class="form-control">
        </div>

        <div class="form-group">
            <label>SIRET</label>
            <input type="text" name="siret" maxlength="14" class="form-control">
        </div>

        <div class="form-group">
            <label>Type d’énergie</label>
            <select name="energie_type" class="form-select">
                <option value="">— Sélectionner —</option>
                <option value="electricite">Électricité</option>
                <option value="gaz">Gaz</option>
            </select>
        </div>

        <div class="form-group">
            <label>PDL / PCE</label>
            <input type="text" name="pdl_pce" class="form-control">
        </div>

        <div class="form-group">
            <label>Date d’échéance du contrat</label>
            <input type="date" name="date_echeance" class="form-control">
        </div>

        <div class="form-group">
            <label>Fournisseur actuel</label>
            <input type="text" name="fournisseur_actuel" class="form-control">
        </div>

        <div class="form-group">
            <label>Commentaires</label>
            <textarea name="commentaire"
                      class="form-control"
                      rows="3"></textarea>
        </div>

        <button type="submit" class="btn btn-primary">
            Envoyer la demande de cotation
        </button>
    </form>
</div>

<!-- ===================== -->
<!-- DOCUMENTS -->
<!-- ===================== -->
<div class="card" style="margin-top:24px;">
    <h5>Documents</h5>

    {% if documents %}
        {% for d in documents %}
        <div class="list-group-item"
             style="display:flex;justify-content:space-between;align-items:center;">
            {{ d.nom }}
            <a href="{{ d.url }}" target="_blank" class="btn btn-secondary">
                Ouvrir
            </a>
        </div>
        {% endfor %}
    {% else %}
        <p class="text-muted">Aucun document.</p>
    {% endif %}
</div>

{% endblock %}
